<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Хамстер Комбат</title>
    <style>
        /* ... (styles) */
    </style>
</head>
<body>
    <div class="container">
        <h1>Хамстер Комбат</h1>
        <div class="hamster-container"> <img src="hamster.jpg" alt="Hamster"> </div>
        <p>Ваш счёт: <span id="score">0</span></p>
        <button id="open-store">Открыть магазин</button>
        <div id="store" class="hidden">
            <h2>Магазин улучшений</h2>
            <button id="close-store">Закрыть магазин</button> <--- Кнопка выхода
            <div class="store-item">
                <div id="upgrade-fedorov">
                    <h3>fedorov</h3> <p>Effect: 200, level: 0</p><img src="fedorov.jpg" alt="fedorov" width="50">
                    <button id="btn-fedorov" data-upgrade="fedorov" data-cost="2500">Купить за 2500</button>
                </div>
            </div>
            </div>
            <div class="store-item">
                <div id="upgrade-korneeva">
                    </div>
           </div>
        </div>

                </div>
             </div>


            <div class="store-item">
                  <div id = upgrade-novikov>
                   </div>

           </div>




 <div class="store-item">



    <div id = "upgrade-epihin">




                </div>




            </div>


             <div  class ="store-item">




                <div  id = upgrade-volkov>

                  </div>


            </div>





<div id="bonus-message" class="hidden">Бонус!</div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', (event) => {
    let score = 0;
    let upgrades = {
        "fedorov": { cost: 2500, owned: 0, effect: 200, img: 'fedorov.jpg' },
        "korneeva": { cost: 5000, owned: 0, effect: 500, img: 'korneeva.jpg' },
        "epihin": { cost: 1000, owned: 0, effect: 100, img: 'epihin.jpg' },
        "zharkova": { cost: 25000, owned: 0, effect: 500, img: 'zharkova.jpg' },
        "sokolova": { cost: 800, owned: 0, effect: 20, img: 'sokolova.jpg' },
        "kozhuhov": { cost: 700, owned: 0, perClick: 1, img: 'kozhuhov.jpg' },
        "novikov": { cost: 10000, owned: 0, effect: 700, img: 'novikov.jpg' },
        "volkov": { cost: 13500, owned: 0, effect: 100, img: 'volkov.jpg' }
    };

    let autoClickerInterval;
    loadGame();
    const hamsterContainer = document.querySelector('.hamster-container');
    hamsterContainer.addEventListener("click", clickHamster);
    const openStoreButton = document.getElementById('open-store');
    const store = document.getElementById('store');
    const closeStoreButton = document.getElementById('close-store'); // Кнопка закрытия магазина


    openStoreButton.addEventListener('click', () => {
        store.classList.remove('hidden');
    });

    closeStoreButton.addEventListener('click', () => {  // Обработчик закрытия магазина
        store.classList.add('hidden');
    });

        function renderShopItem(upgradeId, name, description, cost, img) {
               const upgradeDiv =  document.getElementById(`upgrade-${upgradeId}`)
            upgradeDiv.innerHTML = `<img src="${img}" alt="${name}" width="50"> <h3>${name}</h3> <p>${description}</p> <button id="btn-${upgradeId}" data-upgrade="${upgradeId}" data-cost="${cost}">Купить за ${cost}</button>`;
        }



  function  updateShop(upgradeId){


     const upgrade = upgrades[upgradeId];




 const {cost,  effect, perClick }  = upgrade
        let img = upgrade.img
       let  description


     switch(upgradeId) {

 case "fedorov":
            case "korneeva":
                 case "epihin":
                    case "zharkova":
                         case "sokolova":
                        case "novikov":
            case "volkov":
                 description = `Effect : ${effect}, level : ${upgrade.owned}`

                 break;

             case "kozhuhov":
   description = `Bonus per Click :  ${perClick},  level :  ${owned}`
                 break;

    }



          renderShopItem(upgradeId, upgradeId,description ,cost, img)


attachShopListeners();

   }


        function renderShop() {
       for (const upgradeId in upgrades) {



        const { img, effect, cost, perClick } = upgrades[upgradeId];


         let  description
   let upgradeItem


    switch (upgradeId) {


        case  "fedorov":



          case    "korneeva":
                case "epihin":



                     case   "zharkova":



                      case     "sokolova":



                 case "novikov":
                   case 'volkov':




   description= `Effect: ${effect} level : 0`;
                upgradeItem= `<img src = "${img}" alt ="${upgradeId} width="50"> <h3> ${upgradeId}</h3> <p> ${description} </p> <button id ="btn-${upgradeId} data-upgrade= "${upgradeId}" data-cost ="${cost}">Купить за ${cost} </button>`;
break




              case "kozhuhov":
                description = `Bonus per click :  ${perClick}, level: 0`
                upgradeItem= `<img src = "${img}" alt ="${upgradeId} width="50"> <h3> ${upgradeId}</h3> <p> ${description} </p> <button id ="btn-${upgradeId} data-upgrade= "${upgradeId}" data-cost ="${cost}">Купить за ${cost} </button>`;

             break

 }

         document.getElementById(`upgrade-${upgradeId}`).innerHTML = upgradeItem

  }




         attachShopListeners()




}

    function clickHamster() {



        let clickValue = 1;       //    начальное   значение    клика    1


         if (upgrades.kozhuhov.owned >= 1) {
clickValue += upgrades.kozhuhov.perClick * upgrades.kozhuhov.owned      //    эффект  Кожухова

 }


 score+= clickValue


  updateScoreDisplay()
}



function startAutoClicker() {     //  запускается   при  старте   игры   и   покупке  любого  улучшения,  кроме   kozhuhov



     clearInterval(autoClickerInterval)    //     сбрасываем    текущий    autoClicker

      autoClickerInterval = null
let autoClickValue = 0



     for(const upgradeId in upgrades){     //    добавляем    effect  *  owned      всех   преподавателей





            if(upgradeId !=='kozhuhov' ){     //       кроме    Кожухова



                    autoClickValue += upgrades[upgradeId].effect * upgrades[upgradeId].owned



             }


      }


 autoClickerInterval =  setInterval(()=>{




             score+= autoClickValue   //    увеличиваем очки  с  помощью  autoClickValue


updateScoreDisplay();

         saveGame();


 }, 1000)
    }




    function buyUpgrade(upgradeId) {
       const cost = upgrades[upgradeId].cost


  if (score >= cost){

          score -= cost
           upgrades[upgradeId].owned ++


        updateShop(upgradeId)
        updateScoreDisplay()

              if (upgradeId!=='kozhuhov')   { //  если это не кожухов запускаем  autoClicker

       startAutoClicker();    //    перезапускаем  autoClicker

        }
        alert("Успешно приобретено")
   saveGame()


 }  else{




           alert("Недостаточно очков!")
      }


   }
    function attachShopListeners() {
  const upgradeButtons = document.querySelectorAll('[data-upgrade]')

       upgradeButtons.forEach(button =>{
              button.addEventListener('click', ()=>{
                   const upgradeType = button.dataset.upgrade
               buyUpgrade(upgradeType)
                updateScoreDisplay()
                   })
        })



    }


function loadGame() {
       const savedGame = localStorage.getItem("hamsterCombatSave")


if(savedGame){



             const gameData = JSON.parse(savedGame)
        score =  gameData.score || 0
          upgrades =  gameData.upgrades || {

                  "fedorov": { cost: 2500, owned: 0, effect: 200, img: 'fedorov.jpg' },


            "korneeva": { cost: 5000, owned: 0, effect: 500, img: 'korneeva.jpg' },




           "epihin": { cost: 1000, owned: 0, effect: 100, img: 'epihin.jpg' },
    "zharkova": { cost: 25000, owned: 0, effect: 500, img: 'zharkova.jpg' },

"sokolova": { cost: 800, owned: 0, effect: 20, img: 'sokolova.jpg' },


          "kozhuhov": { cost: 700, owned: 0, perClick: 1, img: 'kozhuhov.jpg' },
             "novikov": { cost: 10000, owned: 0, effect: 700, img: 'novikov.jpg' },
        "volkov": { cost: 13500, owned: 0, effect: 100, img: 'volkov.jpg' }



            }




  }

  renderShop()


 updateScoreDisplay()
    startAutoClicker()

 }

function saveGame(){



     const gameData = {




         score,

         upgrades

  };




  localStorage.setItem('hamsterCombatSave', JSON.stringify(gameData));



 }


        loadGame()
   });



    </script>


</body>
</html>
